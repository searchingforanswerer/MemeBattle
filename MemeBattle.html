<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡¨æƒ…åŒ…å¤§ä½œæˆ˜!-éšæœºé¢˜ç›®ç”Ÿæˆå™¨</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">  <!-- æ·»åŠ è¿™è¡Œ -->
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        #questionDisplay {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
         /* åˆ é™¤æŒ‰é’®æ ·å¼ - çº¢è‰²èƒŒæ™¯ */
        .delete-btn {
            background: #dc3545;
            padding: 6px 12px;
            font-size: 0.9em;
            margin-left: 8px;
        }
        /* ç¼–è¾‘æŒ‰é’®æ ·å¼ - ç»¿è‰²èƒŒæ™¯ */
        .edit-btn {
            background: #28a745;
            padding: 6px 12px;
            font-size: 0.9em;
            margin-left: 5px;
        }
        /* æ‰¹é‡æ“ä½œæŒ‰é’®æ ·å¼ - é»„è‰²èƒŒæ™¯ */
        .batch-btn {
            background: #ffecb3; /* æ›´æµ…çš„é»„è‰² */
            color: #543810; /* æ·±æ£•è‰²æ–‡å­—ï¼Œå¯¹æ¯”åº¦æ›´å¥½ */
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 5px 2px;
            border: 1px solid #ffd54f; /* æ·»åŠ è¾¹æ¡†å¢åŠ å±‚æ¬¡æ„Ÿ */
        }
        .batch-btn:hover {
            background: #ffe082; /* æ‚¬åœæ—¶ç¨æ·±ä¸€ç‚¹ */
            border-color: #ffc107;
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .info {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }

        /* å¼¹çª—åŸºç¡€æ ·å¼ - éšè—çŠ¶æ€ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        /* å¼¹çª—å†…å®¹åŒºåŸŸæ ·å¼ */
        .modal-content {
            background-color: white;
            margin: 30px auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto; /* è¶…å‡ºé«˜åº¦æ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */
            position: relative;
            animation: modalOpen 0.3s ease-out; /* å¼¹çª—æ‰“å¼€åŠ¨ç”» */
        }
        
        /* å¼¹çª—æ‰“å¼€åŠ¨ç”» */
        @keyframes modalOpen {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* å…³é—­æŒ‰é’®æ ·å¼ - å³ä¸Šè§’ Ã— æŒ‰é’® */
        .close-btn {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #666;
            background: none;
            border: none;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-btn:hover {
            color: #000;
            background: #f8f9fa;
            border-radius: 50%;
        }
        
        .modal-title {
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5rem;
        }
        
        /* å¼¹çª—å¤´éƒ¨åŒºåŸŸ - åŒ…å«æ ‡é¢˜å’Œåˆ†éš”çº¿ */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        /* æ‰¹é‡æ“ä½œæŒ‰é’®åŒºåŸŸ */
        .batch-actions {
            display: flex;
            gap: 8px; /* å¢åŠ æŒ‰é’®é—´è· */
            margin-bottom: 15px;
            flex-wrap: wrap; /* å…è®¸æŒ‰é’®æ¢è¡Œ */
            justify-content: center; /* å±…ä¸­å¯¹é½ */
        }

        .custom-questions-list {
            text-align: left;
        }
        
        /* å•ä¸ªé¢˜ç›®é¡¹çš„æ ·å¼ */
        .question-item {
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: flex-start; /* é¡¶éƒ¨å¯¹é½ */
            gap: 10px; /* ç»Ÿä¸€é—´è· */
        }
        
        .question-item:last-child {
            border-bottom: none;
        }
        
         /* é¢˜ç›®å¤é€‰æ¡†æ ·å¼ - ç”¨äºæ‰¹é‡é€‰æ‹© */
        .question-checkbox {
            margin: 8px 0; /* å‚ç›´å±…ä¸­å¯¹é½ */
            transform: scale(1.0); /* å‡å°å¤é€‰æ¡† */
            flex-shrink: 0;
            align-self: flex-start; /* ç¡®ä¿å¤é€‰æ¡†é¡¶éƒ¨å¯¹é½ */
        }

        .question-content {
            flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
            min-width: 0; /* å…è®¸æ”¶ç¼© */
            display: flex; /* è®©ç¼–å·å’Œæ–‡æœ¬åœ¨ä¸€è¡Œ */
            align-items: flex-start; /* é¡¶éƒ¨å¯¹é½ */
            gap: 5px; /* ç¼–å·å’Œæ–‡æœ¬ä¹‹é—´çš„å°é—´è· */
        }

        .question-index {
            font-weight: bold;
            color: #007bff;
            flex-shrink: 0;
            font-size: 0.9em;
        }

        .question-text {
            word-break: break-word;
            white-space: pre-wrap;
            line-height: 1.4;
            flex: 1; /* æ–‡æœ¬å æ®å‰©ä½™ç©ºé—´ */
            min-width: 0; /* å…è®¸æ”¶ç¼© */
        }

        .question-actions {
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex-shrink: 0;
            align-self: flex-start; /* æ“ä½œæŒ‰é’®ä¹Ÿé¡¶éƒ¨å¯¹é½ */
        }
        
        /* ç¼–è¾‘æ¨¡å¼ä¸‹çš„è¾“å…¥æ¡†æ ·å¼ */
        .edit-input {
            width: 100%;
            padding: 8px;
            border: 2px solid #28a745; /* ç»¿è‰²è¾¹æ¡†è¡¨ç¤ºç¼–è¾‘çŠ¶æ€ */
            border-radius: 4px;
            margin: 5px 0;
            box-sizing: border-box;
        }
        
        /* ç¼–è¾‘æ“ä½œæŒ‰é’®åŒºåŸŸ */
        .edit-actions {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }
        
        .save-btn {
            background: #28a745;
            padding: 5px 10px;
            font-size: 0.8em;
        }
        
        .cancel-btn {
            background: #6c757d;
            padding: 5px 10px;
            font-size: 0.8em;
        }

        .no-custom-questions {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 20px 0;
        }

        /* å…¨é€‰æŒ‰é’®æ ·å¼ - ä½œä¸ºæ™®é€šæŒ‰é’®å¤„ç† */
        .select-all-btn {
            background: #e9ecef;
            color: #495057;
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 5px 2px;
            border: 1px solid #dee2e6;
            cursor: pointer; /* ä¿æŒæ‰‹å‹ï¼Œå› ä¸ºè¿™æ˜¯å¯ç‚¹å‡»çš„æŒ‰é’® */
        }
        .select-all-btn:hover {
            background: #dee2e6;
        }
        .select-all-btn.selected {
            background: #ced4da;
            color: #212529;
            font-weight: bold;
        }
        
        /* åƒåœ¾æ¡¶å›¾æ ‡æ ·å¼ - ä¾¿äºè‡ªå®šä¹‰ */
        .trash-icon {
            font-size: 14px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤— è¡¨æƒ…åŒ…å¤§ä½œæˆ˜</h1>
        <div id="questionDisplay">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·å–éšæœºé¢˜ç›®ï¼</div>
        <button onclick="getRandomQuestion()">ğŸ² è·å–éšæœºé¢˜ç›®</button>
        <button onclick="clearCustomQuestions()">ğŸ—‘ï¸ æ¸…ç©ºè‡ªå®šä¹‰é¢˜ç›®</button>
        <div>åŸºç¡€é¢˜ç›®: <span id="baseCount">0</span> | è‡ªå®šä¹‰é¢˜ç›®: <span id="customCount">0</span></div>
        
        <h3>â• æ·»åŠ æ–°é¢˜ç›®</h3>
        <input type="text" id="newQuestion" placeholder="è¾“å…¥é¢˜ç›®å†…å®¹...">
        <button onclick="addQuestion()">æ·»åŠ é¢˜ç›®</button>
        <div class="info">ğŸ’¡ è‡ªå®šä¹‰é¢˜ç›®ä»…ä¿å­˜åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­</div>

        <!-- æŸ¥çœ‹è‡ªå®šä¹‰é¢˜ç›®æŒ‰é’® -->
        <button onclick="showCustomQuestionsModal()">ğŸ“‹ æŸ¥çœ‹è‡ªå®šä¹‰é¢˜ç›®</button>
    </div>

    <!-- å¼¹çª— HTML ç»“æ„ -->
    <div id="customQuestionsModal" class="modal">
        <div class="modal-content">
            <!-- å…³é—­æŒ‰é’® -->
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <!-- å¼¹çª—å¤´éƒ¨ -->
            <div class="modal-header">
                <h2 class="modal-title">æˆ‘çš„è‡ªå®šä¹‰é¢˜ç›®</h2>
            </div>
            
            <!-- æ‰¹é‡æ“ä½œåŒºåŸŸ -->
            <div class="batch-actions">
                <!-- å…¨é€‰æŒ‰é’® -->
                 <button class="select-all-btn" id="selectAllBtn" onclick="toggleSelectAll()">â˜ å…¨é€‰</button>
                <!-- æ‰¹é‡åˆ é™¤æŒ‰é’® -->
                <button class="batch-btn" onclick="deleteSelectedQuestions()">ğŸ—‘ï¸ åˆ é™¤é€‰ä¸­</button>
                <!-- æ¸…ç©ºå…¨éƒ¨æŒ‰é’® -->
                <button class="batch-btn" onclick="clearAllCustomQuestions()">ğŸ§¹ æ¸…ç©ºå…¨éƒ¨</button>
            </div>
            
            <!-- é¢˜ç›®åˆ—è¡¨å®¹å™¨ -->
            <div id="modalQuestionsList" class="custom-questions-list">
                <!-- é¢˜ç›®åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        let baseQuestions = [];      // ä» JSON åŠ è½½çš„åŸºç¡€é¢˜åº“
        let customQuestions = [];    // ç”¨æˆ·æ·»åŠ çš„é¢˜ç›®ï¼ˆlocalStorageï¼‰
        let isAllSelected = false;   // è·Ÿè¸ªå…¨é€‰çŠ¶æ€ 

        // ä» JSON æ–‡ä»¶åŠ è½½åŸºç¡€é¢˜åº“
        async function loadBaseQuestions() {
            try {
                const response = await fetch('questions.json');
                if (!response.ok) {
                    throw new Error('æ— æ³•åŠ è½½é¢˜ç›®æ–‡ä»¶');
                }
                const data = await response.json();
                baseQuestions = data.questions || [];
                loadCustomQuestions(); // åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®
                updateDisplay();
            } catch (error) {
                console.error('åŠ è½½åŸºç¡€é¢˜åº“å¤±è´¥:', error);
                baseQuestions = [
                    "å…¶å®é¢˜åº“åŠ è½½å¤±è´¥äº†ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ",
                    "å–”å–”ï¼Œçœ‹èµ·æ¥å¥½åƒå‡ºé—®é¢˜äº†",
                    "ç¥ä½ ä»Šå¤©å¼€å¿ƒï¼"
                ];
                loadCustomQuestions();
                updateDisplay();
            }
        }

        // ä» localStorage åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®
        function loadCustomQuestions() {
            const saved = localStorage.getItem('customQuestions');
            if (saved) {
                try {
                    customQuestions = JSON.parse(saved);
                } catch (e) {
                    customQuestions = [];
                }
            }
        }

        // ä¿å­˜ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®åˆ° localStorage
        function saveCustomQuestions() {
            localStorage.setItem('customQuestions', JSON.stringify(customQuestions));
            updateDisplay();
        }

        // è·å–æ‰€æœ‰å¯ç”¨é¢˜ç›®ï¼ˆåŸºç¡€ + è‡ªå®šä¹‰ï¼‰
        function getAllQuestions() {
            return [...baseQuestions, ...customQuestions];
        }

        function getRandomQuestion() {
            const allQuestions = getAllQuestions();
            if (allQuestions.length === 0) {
                document.getElementById('questionDisplay').textContent = "è¿˜æ²¡æœ‰é¢˜ç›®å“¦ï¼";
                return;
            }
            const random = allQuestions[Math.floor(Math.random() * allQuestions.length)];
            document.getElementById('questionDisplay').textContent = random;
        }

        function addQuestion() {
            const input = document.getElementById('newQuestion');
            const text = input.value.trim();
            if (text) {
                customQuestions.push(text);
                saveCustomQuestions();
                input.value = '';
            }
        }

        function clearCustomQuestions() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è‡ªå®šä¹‰é¢˜ç›®å—ï¼ŸåŸºç¡€é¢˜åº“ä¸ä¼šè¢«åˆ é™¤ã€‚')) {
                customQuestions = [];
                saveCustomQuestions();
                document.getElementById('questionDisplay').textContent = "è‡ªå®šä¹‰é¢˜ç›®å·²æ¸…ç©ºï¼";
            }
        }

        function updateDisplay() {
            document.getElementById('baseCount').textContent = baseQuestions.length;
            document.getElementById('customCount').textContent = customQuestions.length;
        }


        // æ˜¾ç¤ºè‡ªå®šä¹‰é¢˜ç›®å¼¹çª—
        function showCustomQuestionsModal() {
            const modal = document.getElementById('customQuestionsModal');
            const listElement = document.getElementById('modalQuestionsList');
            
            // æ¸²æŸ“é¢˜ç›®åˆ—è¡¨
            renderModalQuestionsList();
            
            // æ˜¾ç¤ºå¼¹çª—
            modal.style.display = 'block';
            
            // ç¦æ­¢èƒŒæ™¯æ»šåŠ¨ï¼ˆå¯é€‰ï¼‰
            document.body.style.overflow = 'hidden';
        }

        // å…³é—­å¼¹çª—
        function closeModal() {
            const modal = document.getElementById('customQuestionsModal');
            modal.style.display = 'none';
            
            // æ¢å¤èƒŒæ™¯æ»šåŠ¨
            document.body.style.overflow = 'auto';
        }

        // æ¸²æŸ“å¼¹çª—ä¸­çš„é¢˜ç›®åˆ—è¡¨
        function renderModalQuestionsList() {
            const listElement = document.getElementById('modalQuestionsList');
            const selectAllBtn = document.getElementById('selectAllBtn');
            
            // é‡ç½®å…¨é€‰çŠ¶æ€
            if (selectAllBtn) {
                selectAllBtn.innerHTML = 'â˜ å…¨é€‰';
                selectAllBtn.classList.remove('selected');
                isAllSelected = false;
            }
            
            // å¤„ç†ç©ºçŠ¶æ€
            if (customQuestions.length === 0) {
                listElement.innerHTML = '<div class="no-custom-questions">æš‚æ— è‡ªå®šä¹‰é¢˜ç›®</div>';
                return;
            }
            
            // ç”Ÿæˆé¢˜ç›®åˆ—è¡¨HTML - ä¿®å¤ï¼šä½¿ç”¨æ–°çš„å¸ƒå±€ç»“æ„
            let html = '';
            customQuestions.forEach((question, index) => {
                html += `
                    <div class="question-item">
                        <input type="checkbox" class="question-checkbox" data-index="${index}" onchange="checkSelectAllStatus()">
                        <div class="question-content">
                            <span class="question-index">${index + 1}.</span>
                            <span class="question-text">${question}</span>
                        </div>
                        <div class="question-actions">
                            <button class="edit-btn" onclick="startEditQuestion(${index})">âœï¸ ç¼–è¾‘</button>
                            <button class="delete-btn" onclick="deleteSingleQuestion(${index})">
                                <span class="trash-icon">ğŸ—‘ï¸</span>
                                åˆ é™¤
                            </button>
                        </div>
                    </div>
                `;
            });
            
            listElement.innerHTML = html;
        }
        // ========== å¼¹çª—ç®¡ç†åŠŸèƒ½ç»“æŸ ==========

        // ========== æ–°å¢ï¼šå•ä¸ªé¢˜ç›®ç¼–è¾‘åŠŸèƒ½ ==========
        // å¼€å§‹ç¼–è¾‘é¢˜ç›® - åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼
        function startEditQuestion(index) {
            const questionItem = document.querySelector(`.question-item:nth-child(${index + 1})`);
            const questionText = customQuestions[index];
            
            // åˆ›å»ºç¼–è¾‘ç•Œé¢HTML - ä¿®æ”¹ï¼šå¢åŠ è¾“å…¥æ¡†å®½åº¦
            const editHtml = `
                <input type="text" class="edit-input" id="edit-input-${index}" value="${questionText}" maxlength="200">
                <div class="edit-actions">
                    <button class="save-btn" onclick="saveEditedQuestion(${index})">âœ“ ä¿å­˜</button>
                    <button class="cancel-btn" onclick="cancelEditQuestion(${index})">âœ• å–æ¶ˆ</button>
                </div>
            `;
            
            // æ›¿æ¢é¢˜ç›®å†…å®¹ä¸ºç¼–è¾‘ç•Œé¢
            const questionContent = questionItem.querySelector('.question-content');
            questionContent.innerHTML = editHtml;
            
            // è‡ªåŠ¨èšç„¦åˆ°è¾“å…¥æ¡†ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
            document.getElementById(`edit-input-${index}`).focus();
        }

        // ä¿å­˜ç¼–è¾‘åçš„é¢˜ç›®
        function saveEditedQuestion(index) {
            const input = document.getElementById(`edit-input-${index}`);
            const newText = input.value.trim();
            
            // å¤„ç†ç©ºå†…å®¹æƒ…å†µ
            if (newText === '') {
                if (confirm('é¢˜ç›®å†…å®¹ä¸ºç©ºï¼Œæ˜¯å¦åˆ é™¤æ­¤é¢˜ç›®ï¼Ÿ')) {
                    customQuestions.splice(index, 1); // ä»æ•°ç»„ä¸­åˆ é™¤
                    saveCustomQuestions(); // ä¿å­˜åˆ°localStorage
                    renderModalQuestionsList(); // é‡æ–°æ¸²æŸ“åˆ—è¡¨
                } else {
                    cancelEditQuestion(index); // å–æ¶ˆç¼–è¾‘
                }
                return;
            }
            
            // ä¿å­˜æ–°å†…å®¹
            customQuestions[index] = newText;
            saveCustomQuestions();
            renderModalQuestionsList();
        }

        // å–æ¶ˆç¼–è¾‘ - æ¢å¤åŸé¢˜ç›®æ˜¾ç¤º
        function cancelEditQuestion(index) {
            renderModalQuestionsList();
        }
        // ========== å•ä¸ªé¢˜ç›®ç¼–è¾‘åŠŸèƒ½ç»“æŸ ==========

        // ========== æ–°å¢ï¼šåˆ é™¤åŠŸèƒ½ ==========
        // åˆ é™¤å•ä¸ªé¢˜ç›®
        function deleteSingleQuestion(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¢˜ç›®å—ï¼Ÿ')) {
                customQuestions.splice(index, 1); // ä»æ•°ç»„ä¸­åˆ é™¤æŒ‡å®šç´¢å¼•çš„é¢˜ç›®
                saveCustomQuestions(); // ä¿å­˜æ›´æ”¹
                renderModalQuestionsList(); // é‡æ–°æ¸²æŸ“åˆ—è¡¨
            }
        }
        // ========== åˆ é™¤åŠŸèƒ½ç»“æŸ ==========

        // ========== æ–°å¢ï¼šæ‰¹é‡æ“ä½œåŠŸèƒ½ ==========
        // å…¨é€‰/å–æ¶ˆå…¨é€‰åŠŸèƒ½ - ä¿®æ”¹ï¼šä½¿ç”¨æŒ‰é’®å®ç°
        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.question-checkbox');
            const selectAllBtn = document.getElementById('selectAllBtn');
            
            if (isAllSelected) {
                // å–æ¶ˆå…¨é€‰
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                selectAllBtn.innerHTML = 'â˜ å…¨é€‰';
                selectAllBtn.classList.remove('selected');
                isAllSelected = false;
            } else {
                // å…¨é€‰
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                });
                selectAllBtn.innerHTML = 'â˜‘ å…¨é€‰';
                selectAllBtn.classList.add('selected');
                isAllSelected = true;
            }
        }

        // æ£€æŸ¥é€‰æ‹©çŠ¶æ€ - å½“ç”¨æˆ·æ‰‹åŠ¨å‹¾é€‰å¤é€‰æ¡†æ—¶æ›´æ–°å…¨é€‰æŒ‰é’®çŠ¶æ€
        function checkSelectAllStatus() {
            const checkboxes = document.querySelectorAll('.question-checkbox');
            const checkedCheckboxes = document.querySelectorAll('.question-checkbox:checked');
            const selectAllBtn = document.getElementById('selectAllBtn');
            
            if (checkboxes.length === 0) {
                isAllSelected = false;
                selectAllBtn.innerHTML = 'â˜ å…¨é€‰';
                selectAllBtn.classList.remove('selected');
                return;
            }
            
            if (checkedCheckboxes.length === checkboxes.length) {
                // å…¨éƒ¨é€‰ä¸­
                if (!isAllSelected) {
                    selectAllBtn.innerHTML = 'â˜‘ å…¨é€‰';
                    selectAllBtn.classList.add('selected');
                    isAllSelected = true;
                }
            } else if (checkedCheckboxes.length === 0) {
                // å…¨éƒ¨å–æ¶ˆ
                if (isAllSelected) {
                    selectAllBtn.innerHTML = 'â˜ å…¨é€‰';
                    selectAllBtn.classList.remove('selected');
                    isAllSelected = false;
                }
            } else {
                // éƒ¨åˆ†é€‰ä¸­
                if (isAllSelected) {
                    selectAllBtn.innerHTML = 'â˜ å…¨é€‰';
                    selectAllBtn.classList.remove('selected');
                    isAllSelected = false;
                }
            }
        }

        // åˆ é™¤é€‰ä¸­çš„é¢˜ç›®ï¼ˆæ‰¹é‡åˆ é™¤ï¼‰
        function deleteSelectedQuestions() {
            const checkboxes = document.querySelectorAll('.question-checkbox:checked');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰é€‰ä¸­çš„é¢˜ç›®
            if (checkboxes.length === 0) {
                alert('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„é¢˜ç›®ï¼');
                return;
            }
            
            if (confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${checkboxes.length} ä¸ªé¢˜ç›®å—ï¼Ÿ`)) {
                // é‡è¦ï¼šä»åå¾€å‰åˆ é™¤ï¼Œé¿å…ç´¢å¼•å˜åŒ–å¯¼è‡´çš„é—®é¢˜
                const indicesToDelete = Array.from(checkboxes)
                    .map(checkbox => parseInt(checkbox.dataset.index))
                    .sort((a, b) => b - a); // é™åºæ’åˆ—ï¼ˆä»å¤§åˆ°å°ï¼‰
                
                // ä¾æ¬¡åˆ é™¤é¢˜ç›®
                indicesToDelete.forEach(index => {
                    customQuestions.splice(index, 1);
                });
                
                saveCustomQuestions();
                renderModalQuestionsList();
            }
        }

        // æ¸…ç©ºæ‰€æœ‰è‡ªå®šä¹‰é¢˜ç›®ï¼ˆæ‰¹é‡æ“ä½œçš„ç‰¹æ®Šæƒ…å†µï¼‰
        function clearAllCustomQuestions() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è‡ªå®šä¹‰é¢˜ç›®å—ï¼Ÿ')) {
                customQuestions = [];
                saveCustomQuestions();
                renderModalQuestionsList();
            }
        }
        // ========== æ‰¹é‡æ“ä½œåŠŸèƒ½ç»“æŸ ==========


        // ç‚¹å‡»å¼¹çª—å¤–åŒºåŸŸå…³é—­å¼¹çª—
        window.onclick = function(event) {
            const modal = document.getElementById('customQuestionsModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // æŒ‰ ESC é”®å…³é—­å¼¹çª—
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = loadBaseQuestions;
    </script>
</body>
</html>