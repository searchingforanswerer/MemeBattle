<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšæœºé¢˜ç›®ç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        #questionDisplay {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .info {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ² éšæœºé¢˜ç›®ç”Ÿæˆå™¨</h1>
        <div id="questionDisplay">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·å–éšæœºé¢˜ç›®ï¼</div>
        <button onclick="getRandomQuestion()">ğŸ² è·å–éšæœºé¢˜ç›®</button>
        <button onclick="clearCustomQuestions()">ğŸ—‘ï¸ æ¸…ç©ºè‡ªå®šä¹‰é¢˜ç›®</button>
        <div>åŸºç¡€é¢˜ç›®: <span id="baseCount">0</span> | è‡ªå®šä¹‰é¢˜ç›®: <span id="customCount">0</span></div>
        
        <h3>â• æ·»åŠ æ–°é¢˜ç›®</h3>
        <input type="text" id="newQuestion" placeholder="è¾“å…¥é¢˜ç›®å†…å®¹...">
        <button onclick="addQuestion()">æ·»åŠ é¢˜ç›®</button>
        <div class="info">ğŸ’¡ è‡ªå®šä¹‰é¢˜ç›®ä»…ä¿å­˜åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­</div>
    </div>

    <script>
        let baseQuestions = [];      // ä» JSON åŠ è½½çš„åŸºç¡€é¢˜åº“
        let customQuestions = [];    // ç”¨æˆ·æ·»åŠ çš„é¢˜ç›®ï¼ˆlocalStorageï¼‰

        // ä» JSON æ–‡ä»¶åŠ è½½åŸºç¡€é¢˜åº“
        async function loadBaseQuestions() {
            try {
                const response = await fetch('questions.json');
                if (!response.ok) {
                    throw new Error('æ— æ³•åŠ è½½é¢˜ç›®æ–‡ä»¶');
                }
                const data = await response.json();
                baseQuestions = data.questions || [];
                loadCustomQuestions(); // åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®
                updateDisplay();
            } catch (error) {
                console.error('åŠ è½½åŸºç¡€é¢˜åº“å¤±è´¥:', error);
                baseQuestions = [
                    "æè¿°ä¸€ä¸‹ä½ ç†æƒ³ä¸­çš„ä¸€å¤©æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ",
                    "å¦‚æœä½ å¯ä»¥æ‹¥æœ‰ä»»ä½•ä¸€ç§è¶…èƒ½åŠ›ï¼Œä½ ä¼šé€‰æ‹©ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ",
                    "åˆ†äº«ä¸€ä¸ªæ”¹å˜äº†ä½ äººç”Ÿè§‚çš„ç»å†ã€‚"
                ];
                loadCustomQuestions();
                updateDisplay();
            }
        }

        // ä» localStorage åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®
        function loadCustomQuestions() {
            const saved = localStorage.getItem('customQuestions');
            if (saved) {
                try {
                    customQuestions = JSON.parse(saved);
                } catch (e) {
                    customQuestions = [];
                }
            }
        }

        // ä¿å­˜ç”¨æˆ·è‡ªå®šä¹‰é¢˜ç›®åˆ° localStorage
        function saveCustomQuestions() {
            localStorage.setItem('customQuestions', JSON.stringify(customQuestions));
            updateDisplay();
        }

        // è·å–æ‰€æœ‰å¯ç”¨é¢˜ç›®ï¼ˆåŸºç¡€ + è‡ªå®šä¹‰ï¼‰
        function getAllQuestions() {
            return [...baseQuestions, ...customQuestions];
        }

        function getRandomQuestion() {
            const allQuestions = getAllQuestions();
            if (allQuestions.length === 0) {
                document.getElementById('questionDisplay').textContent = "è¿˜æ²¡æœ‰é¢˜ç›®å“¦ï¼";
                return;
            }
            const random = allQuestions[Math.floor(Math.random() * allQuestions.length)];
            document.getElementById('questionDisplay').textContent = random;
        }

        function addQuestion() {
            const input = document.getElementById('newQuestion');
            const text = input.value.trim();
            if (text) {
                customQuestions.push(text);
                saveCustomQuestions();
                input.value = '';
            }
        }

        function clearCustomQuestions() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è‡ªå®šä¹‰é¢˜ç›®å—ï¼ŸåŸºç¡€é¢˜åº“ä¸ä¼šè¢«åˆ é™¤ã€‚')) {
                customQuestions = [];
                saveCustomQuestions();
                document.getElementById('questionDisplay').textContent = "è‡ªå®šä¹‰é¢˜ç›®å·²æ¸…ç©ºï¼";
            }
        }

        function updateDisplay() {
            document.getElementById('baseCount').textContent = baseQuestions.length;
            document.getElementById('customCount').textContent = customQuestions.length;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = loadBaseQuestions;
    </script>
</body>
</html>